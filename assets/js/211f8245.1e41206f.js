"use strict";(self.webpackChunksurge_docs=self.webpackChunksurge_docs||[]).push([[5506],{5037:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"guides/surge-on-hoodi/run-relayer","title":"Run Relayer","description":"This guide is fairly similar to the Deploy Relayer guide. The main difference is that this guide is focused on running the components of the Surge rollup on the Hoodi testnet, while the other one is for the devnet.","source":"@site/docs/guides/surge-on-hoodi/run-relayer.mdx","sourceDirName":"guides/surge-on-hoodi","slug":"/guides/surge-on-hoodi/run-relayer","permalink":"/docs/guides/surge-on-hoodi/run-relayer","draft":false,"unlisted":false,"editUrl":"https://github.com/NethermindEth/surge-docs/tree/main/docs/guides/surge-on-hoodi/run-relayer.mdx","tags":[],"version":"current","lastUpdatedAt":1754924688000,"sidebarPosition":4,"frontMatter":{"title":"Run Relayer","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Run L2","permalink":"/docs/guides/surge-on-hoodi/run-l2"},"next":{"title":"Run Bridge UI","permalink":"/docs/guides/surge-on-hoodi/run-bridge-ui"}}');var i=t(4848),a=t(8453);t(5537),t(9329);const o={title:"Run Relayer",sidebar_position:4},s="Run Relayer",l={},c=[{value:"Step 1: Clone the Repository",id:"step-1-clone-the-repository",level:2},{value:"Step 2: Navigate to the Relayer Directory",id:"step-2-navigate-to-the-relayer-directory",level:2},{value:"Step 3: Environment Configuration",id:"step-3-environment-configuration",level:2},{value:"Step 4: Relayer Launch",id:"step-4-relayer-launch",level:2},{value:"Step 1: Initialize Components",id:"step-1-initialize-components",level:3},{value:"Step 2: Run Database Migrations",id:"step-2-run-database-migrations",level:3},{value:"Step 3: Start Relayer Service",id:"step-3-start-relayer-service",level:3},{value:"Verification",id:"verification",level:2},{value:"Health Checks",id:"health-checks",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"run-relayer",children:"Run Relayer"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["This guide is fairly similar to the ",(0,i.jsx)(n.a,{href:"/docs/guides/running-surge/deploy-relayer",children:"Deploy Relayer"})," guide. The main difference is that this guide is focused on running the components of the Surge rollup on the Hoodi testnet, while the other one is for the devnet."]})}),"\n",(0,i.jsx)(n.p,{children:"The Relayer is a key component that facilitates cross-layer communication between Layer 1 and Layer 2, such as submitting proofs or syncing finalized state. It ensures that Surge\u2019s L2 state transitions are correctly reflected and verified on L1."}),"\n",(0,i.jsx)(n.p,{children:"This guide walks you through running and configuring the Surge Relayer."}),"\n",(0,i.jsxs)(n.p,{children:["To understand how the Relayer fits into the broader system, check the ",(0,i.jsx)(n.a,{href:"/docs/about/architecture",children:"Surge Architecture documentation"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"step-1-clone-the-repository",children:"Step 1: Clone the Repository"}),"\n",(0,i.jsxs)(n.p,{children:["Clone the ",(0,i.jsx)(n.a,{href:"https://github.com/NethermindEth/surge-taiko-mono",children:"Surge Taiko Mono repository"})," to your local environment and navigate into it:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/NethermindEth/surge-taiko-mono.git\ncd surge-taiko-mono/\n"})}),"\n",(0,i.jsx)(n.h2,{id:"step-2-navigate-to-the-relayer-directory",children:"Step 2: Navigate to the Relayer Directory"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd packages/relayer\n"})}),"\n",(0,i.jsx)(n.h2,{id:"step-3-environment-configuration",children:"Step 3: Environment Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Create your environment configuration file (",(0,i.jsx)(n.code,{children:".env"}),") by copying the provided sample:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cp .env.hoodi .env\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Make sure to update ",(0,i.jsx)(n.code,{children:".env"})," to match your environment such as updating ",(0,i.jsx)(n.code,{children:"L1_RPC_URL"})," and ",(0,i.jsx)(n.code,{children:"L2_RPC_URL"})," to your own node URLs."]})}),"\n",(0,i.jsx)(n.h2,{id:"step-4-relayer-launch",children:"Step 4: Relayer Launch"}),"\n",(0,i.jsx)(n.p,{children:"Launch the relayer components in the following sequence:"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-initialize-components",children:"Step 1: Initialize Components"}),"\n",(0,i.jsx)(n.p,{children:"Run the command to start necessary services:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker compose --profile init up -d\n"})}),"\n",(0,i.jsx)(n.p,{children:"This starts essential services such as the relayer database and queue."}),"\n",(0,i.jsx)(n.h3,{id:"step-2-run-database-migrations",children:"Step 2: Run Database Migrations"}),"\n",(0,i.jsx)(n.p,{children:"Allow some time (20 seconds recommended) for services to initialize, then execute migrations:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Wait for services to initialize\nsleep 20\n\n# Execute migrations\ndocker compose --profile migrations up\n"})}),"\n",(0,i.jsx)(n.p,{children:"This step establishes your database schema and initial configurations required by the relayer."}),"\n",(0,i.jsx)(n.h3,{id:"step-3-start-relayer-service",children:"Step 3: Start Relayer Service"}),"\n",(0,i.jsx)(n.p,{children:"Launch the main relayer services, connecting both L1 and L2:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker compose --profile l1 --profile l2 --profile api up -d\n"})}),"\n",(0,i.jsx)(n.p,{children:"This will activate the relayer service along with API interfaces."}),"\n",(0,i.jsx)(n.h2,{id:"verification",children:"Verification"}),"\n",(0,i.jsx)(n.p,{children:"Post-launch verification steps:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure the database initialization succeeded."}),"\n",(0,i.jsx)(n.li,{children:"Confirm database migrations completed without errors."}),"\n",(0,i.jsx)(n.li,{children:"Validate the relayer is running and properly connected to L1 and L2."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"health-checks",children:"Health Checks"}),"\n",(0,i.jsx)(n.p,{children:"Use the following commands to verify component health:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# List running containers\ndocker compose ps\n\n# View logs for specific components, e.g., L1 processor\ndocker logs relayer-l1-processor\n\n# Monitor database logs\ndocker compose logs db -f --tail=100\n\n# Review migration logs for errors.\ndocker compose logs migrations\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Important",type:"warning",children:(0,i.jsx)(n.p,{children:"Ensure all relayer components are fully operational before proceeding with network operations. The relayer is a critical component for cross-layer communication."})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},9329:(e,n,t)=>{t.d(n,{A:()=>o});t(6540);var r=t(4164);const i={tabItem:"tabItem_Ymn6"};var a=t(4848);function o(e){let{children:n,hidden:t,className:o}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,o),hidden:t,children:n})}},5537:(e,n,t)=>{t.d(n,{A:()=>k});var r=t(6540),i=t(4164),a=t(5627),o=t(6347),s=t(372),l=t(604),c=t(1861),u=t(8749);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:i}}=e;return{value:n,label:t,attributes:r,default:i}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const i=(0,o.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(i.location.search);n.set(a,e),i.replace({...i.location,search:n.toString()})}),[a,i])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,a=h(e),[o,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a}))),[c,d]=m({queryString:t,groupId:i}),[g,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,a]=(0,u.Dv)(t);return[i,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:i}),y=(()=>{const e=c??g;return p({value:e,tabValues:a})?e:null})();(0,s.A)((()=>{y&&l(y)}),[y]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),f(e)}),[d,f,a]),tabValues:a}}var f=t(9136);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(4848);function b(e){let{className:n,block:t,selectedValue:r,selectValue:o,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),u=e=>{const n=e.currentTarget,t=l.indexOf(n),i=s[t].value;i!==r&&(c(n),o(i))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:s.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...a,className:(0,i.A)("tabs__item",y.tabItem,a?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function x(e){let{lazy:n,children:t,selectedValue:a}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function j(e){const n=g(e);return(0,v.jsxs)("div",{className:(0,i.A)("tabs-container",y.tabList),children:[(0,v.jsx)(b,{...n,...e}),(0,v.jsx)(x,{...n,...e})]})}function k(e){const n=(0,f.A)();return(0,v.jsx)(j,{...e,children:d(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var r=t(6540);const i={},a=r.createContext(i);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);