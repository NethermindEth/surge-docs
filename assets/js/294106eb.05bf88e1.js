"use strict";(self.webpackChunksurge_docs=self.webpackChunksurge_docs||[]).push([[162],{8826:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"guides/running-surge/deploy-l2","title":"Deploy L2 and Surge Protocols","description":"A Layer 2 network builds on top of Layer 1 to increase scalability and reduce transaction costs, while still inheriting L1\'s security. For Surge, the L2 network is where user transactions are executed and blocks are proposed and proven.","source":"@site/docs/guides/running-surge/deploy-l2.mdx","sourceDirName":"guides/running-surge","slug":"/guides/running-surge/deploy-l2","permalink":"/docs/guides/running-surge/deploy-l2","draft":false,"unlisted":false,"editUrl":"https://github.com/NethermindEth/surge-docs/tree/main/docs/guides/running-surge/deploy-l2.mdx","tags":[],"version":"current","lastUpdatedAt":1761209900000,"sidebarPosition":2,"frontMatter":{"title":"Deploy L2 and Surge Protocols","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Deploy L1","permalink":"/docs/guides/running-surge/deploy-l1"},"next":{"title":"Set up Provers","permalink":"/docs/guides/running-surge/provers/"}}');var o=r(4848),s=r(8453);r(1470),r(9365);const i={title:"Deploy L2 and Surge Protocols",sidebar_position:2},l="Deploy L2 and Surge Protocols",a={},c=[{value:"Protocol Deployment",id:"protocol-deployment",level:2},{value:"1. Clone Repository",id:"1-clone-repository",level:3},{value:"2. Start Protocol Deployment Script",id:"2-start-protocol-deployment-script",level:3},{value:"Surge Environment",id:"surge-environment",level:4},{value:"Remote or Local",id:"remote-or-local",level:4},{value:"Devnet Machine (Devnet + Remote only)",id:"devnet-machine-devnet--remote-only",level:4},{value:"Timelocked Owner",id:"timelocked-owner",level:4},{value:"3. Prover Deployment",id:"3-prover-deployment",level:3},{value:"SGX Provers",id:"sgx-provers",level:4},{value:"ZK Provers",id:"zk-provers",level:4},{value:"4. Depositing Bond",id:"4-depositing-bond",level:3},{value:"5. Next Steps",id:"5-next-steps",level:3},{value:"Stack Deployment",id:"stack-deployment",level:2},{value:"1. Start Script",id:"1-start-script",level:3},{value:"2. Stack Components",id:"2-stack-components",level:3},{value:"3. Relayer and L2 Smart Contracts",id:"3-relayer-and-l2-smart-contracts",level:3},{value:"Bridge UI",id:"bridge-ui",level:4},{value:"Relayer",id:"relayer",level:4},{value:"BlockScout",id:"blockscout",level:4},{value:"Cleanup and Management",id:"cleanup-and-management",level:2},{value:"Removing Deployment",id:"removing-deployment",level:3},{value:"Verification",id:"verification",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"deploy-l2-and-surge-protocols",children:"Deploy L2 and Surge Protocols"})}),"\n",(0,o.jsx)(n.p,{children:"A Layer 2 network builds on top of Layer 1 to increase scalability and reduce transaction costs, while still inheriting L1's security. For Surge, the L2 network is where user transactions are executed and blocks are proposed and proven."}),"\n",(0,o.jsxs)(n.p,{children:["This guide provides clear instructions for deploying Surge's L2 components using the ",(0,o.jsx)(n.a,{href:"https://github.com/NethermindEth/simple-surge-node",children:"Simple Surge Node"}),", enabling you to run and test the core rollup logic."]}),"\n",(0,o.jsxs)(n.p,{children:["To see how L2 fits into the overall system, refer to the ",(0,o.jsx)(n.a,{href:"/docs/about/architecture",children:"Surge Architecture documentation"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"protocol-deployment",children:"Protocol Deployment"}),"\n",(0,o.jsx)(n.p,{children:"Follow these steps to set up and deploy your L2 protocol:"}),"\n",(0,o.jsx)(n.h3,{id:"1-clone-repository",children:"1. Clone Repository"}),"\n",(0,o.jsxs)(n.p,{children:["Clone the ",(0,o.jsx)(n.a,{href:"https://github.com/NethermindEth/simple-surge-node",children:"Simple Surge Node"})," repository and navigate into the directory:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/NethermindEth/simple-surge-node.git\ncd simple-surge-node\n"})}),"\n",(0,o.jsx)(n.h3,{id:"2-start-protocol-deployment-script",children:"2. Start Protocol Deployment Script"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://github.com/NethermindEth/simple-surge-node",children:"Simple Surge Node"})," automates the deployment of L2 and Surge protocol components using a convenient script.\nRun the deployment script with:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"./surge-protocol-deployer.sh\n"})}),"\n",(0,o.jsx)(n.p,{children:"You'll be prompted to confirm the deployment parameters. Here are the main prompts:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n  \u26a0\ufe0f Select which Surge environment to use:\n\u2551\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2551\n\u2551 1 for Devnet                                                 \u2551\n\u2551 2 for Staging                                                \u2551\n\u2551 3 for Testnet                                                \u2551\n\u2551 [default: Devnet]                                            \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n  \u26a0\ufe0f Select remote or local:\n\u2551\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2551\n\u2551 0 for local                                                  \u2551\n\u2551 1 for remote                                                 \u2551\n\u2551 [default: local]                                             \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n  \u26a0\ufe0f Select which devnet machine to use:\n\u2551\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2551\n\u2551 1 for Devnet 1 (prover)                                      \u2551\n\u2551 2 for Devnet 2 (taiko-client)                                \u2551\n\u2551 [default: others]                                            \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Use timelocked owner? (true/false) [default: false]          \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,o.jsx)(n.h4,{id:"surge-environment",children:"Surge Environment"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Devnet (1)"}),": For local testing and development. Deploys full protocol contracts."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Staging (2)"}),": Uses pre-deployed staging environment. Skips protocol deployment and directs you to run ",(0,o.jsx)(n.code,{children:"surge-stack-deployer.sh"})," directly."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Testnet (3)"}),": Uses pre-deployed testnet environment. Skips protocol deployment and directs you to run ",(0,o.jsx)(n.code,{children:"surge-stack-deployer.sh"})," directly."]}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{title:"Staging and Testnet",type:"note",children:(0,o.jsxs)(n.p,{children:["For Staging and Testnet environments, the protocol contracts are already deployed. The script will exit and instruct you to copy the appropriate ",(0,o.jsx)(n.code,{children:".env"})," file and run ",(0,o.jsx)(n.code,{children:"surge-stack-deployer.sh"})," directly."]})}),"\n",(0,o.jsx)(n.admonition,{title:"Environment Configuration",type:"tip",children:(0,o.jsxs)(n.p,{children:["After you choose the environment, the script will create a corresponding ",(0,o.jsx)(n.code,{children:".env"})," file in the root directory.\nThe environment file includes default values for configuration.\nYou can customize these values, such as L1 and L2 settings, genesis hashes, and addresses, as needed, but typically no changes are required for standard deployments."]})}),"\n",(0,o.jsx)(n.h4,{id:"remote-or-local",children:"Remote or Local"}),"\n",(0,o.jsxs)(n.p,{children:["Choose ",(0,o.jsx)(n.code,{children:"local"})," if you are deploying everything on a single machine. Choose ",(0,o.jsx)(n.code,{children:"remote"})," if you are deploying across multiple machines or connecting to remote devnet instances."]}),"\n",(0,o.jsx)(n.h4,{id:"devnet-machine-devnet--remote-only",children:"Devnet Machine (Devnet + Remote only)"}),"\n",(0,o.jsxs)(n.p,{children:["This option is only available when you select ",(0,o.jsx)(n.code,{children:"Devnet"})," environment and ",(0,o.jsx)(n.code,{children:"remote"})," deployment:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Devnet 1 (prover)"}),": Connects to ",(0,o.jsx)(n.code,{children:"devnet-one.surge.wtf"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Devnet 2 (taiko-client)"}),": Connects to ",(0,o.jsx)(n.code,{children:"devnet-two.surge.wtf"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Others"}),": Uses your machine's IP address for custom devnet deployment"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"timelocked-owner",children:"Timelocked Owner"}),"\n",(0,o.jsx)(n.p,{children:"You can choose whether to use a timelocked owner for the deployed contracts.\nThis feature allows transferring the ownership of the contracts to a timelock contract,\nwhich will delay any ownership changes by a predefined time period."}),"\n",(0,o.jsxs)(n.p,{children:["For testing and non-production environments, you can safely choose ",(0,o.jsx)(n.code,{children:"false"})," to simplify management."]}),"\n",(0,o.jsx)(n.p,{children:"Note that with a timelocked owner you won't be able to re-register provers and change these parameters later without redeploying the protocol."}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsx)(n.mdxAdmonitionTitle,{}),(0,o.jsxs)(n.p,{children:["After these prompts, the script will deploy protocol contracts and output addresses of created smart contracts.\nSome of these addresses (e.g. ",(0,o.jsx)(n.code,{children:"SUCCINCT_VERIFIER"}),", ",(0,o.jsx)(n.code,{children:"RISC0_GROTH16_VERIFIER"}),") are required for prover configuration.\nYou can also find these addresses in the ",(0,o.jsx)(n.code,{children:"deployment/deploy_l1.json"})," file."]})]}),"\n",(0,o.jsxs)(n.admonition,{title:"Resuming Deployment",type:"tip",children:[(0,o.jsxs)(n.p,{children:["You can safely cancel the script at any time by pressing ",(0,o.jsx)(n.code,{children:"Ctrl + C"}),". The script saves the progress and you can resume later.\nIf you have already deployed the protocol contracts, the script will ask you:"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n  \u26a0\ufe0f Surge L1 deployment already completed\n  (deploy_l1.json exists)\n\u2551\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2551\n\u2551 Start a new deployment? (true/false) [default: false]        \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),(0,o.jsx)(n.p,{children:"Here you can redeploy the protocol or just use the existing deployment."})]}),"\n",(0,o.jsx)(n.h3,{id:"3-prover-deployment",children:"3. Prover Deployment"}),"\n",(0,o.jsx)(n.p,{children:"In Surge, provers are required to be registered in the protocol before they can start proving tasks.\nThe script will ask whether provers are running and ready for registration:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Running provers? (true/false) [default: false]               \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,o.jsxs)(n.p,{children:["If you choose ",(0,o.jsx)(n.code,{children:"true"}),", the script will guide you through setting up different prover types:"]}),"\n",(0,o.jsx)(n.h4,{id:"sgx-provers",children:"SGX Provers"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"SGX Raiko (RETH)"}),": For SGX-based proving with RETH execution"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"SGX Gaiko (GETH)"}),": For SGX-based proving with GETH execution"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"zk-provers",children:"ZK Provers"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"SP1"}),": For SP1-based zero-knowledge proving"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"RISC0"}),": For RISC0-based zero-knowledge proving"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"For each prover type you choose to run, the script will:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Retrieve guest data from your prover endpoints"}),"\n",(0,o.jsx)(n.li,{children:"Validate required parameters (MR_ENCLAVE, MR_SIGNER, program keys, etc.)"}),"\n",(0,o.jsx)(n.li,{children:"Set up and register the verifier contracts"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["You can type ",(0,o.jsx)(n.code,{children:"false"})," and skip this step if you don't want to run provers.\nOtherwise, if you want to run provers, follow the instructions in the\n",(0,o.jsx)(n.a,{href:"/docs/guides/running-surge/provers/",children:"Provers Setup Guide"})," to deploy and register your provers before continuing."]}),"\n",(0,o.jsx)(n.h3,{id:"4-depositing-bond",children:"4. Depositing Bond"}),"\n",(0,o.jsx)(n.p,{children:"The script will ask you whether you want to deposit the proving liveness bond for your provers:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Deposit bond? (true/false) [default: true]                   \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Enter bond amount (in ETH, default: 1000)                    \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,o.jsx)(n.p,{children:"It's recommended to deposit the bond to ensure your provers remain active and available for proving tasks.\nThe default bond amount is 1000 ETH (converted to wei automatically)."}),"\n",(0,o.jsx)(n.h3,{id:"5-next-steps",children:"5. Next Steps"}),"\n",(0,o.jsx)(n.p,{children:"After completing the protocol deployment, you can proceed to deploy Surge stack components using:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"./surge-stack-deployer.sh\n"})}),"\n",(0,o.jsx)(n.h2,{id:"stack-deployment",children:"Stack Deployment"}),"\n",(0,o.jsx)(n.h3,{id:"1-start-script",children:"1. Start Script"}),"\n",(0,o.jsx)(n.p,{children:"Start the script for deploying Surge stack components:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"./surge-stack-deployer.sh\n"})}),"\n",(0,o.jsx)(n.p,{children:"You'll see the same environment selection prompts as in the protocol deployment script.\nSet the same values as before to ensure the script uses the correct configuration."}),"\n",(0,o.jsx)(n.admonition,{title:"Environment File",type:"tip",children:(0,o.jsxs)(n.p,{children:["The stack deployer will check for an existing ",(0,o.jsx)(n.code,{children:".env"})," file. If not found, it will exit with an error asking you to create one first by running the protocol deployer."]})}),"\n",(0,o.jsx)(n.h3,{id:"2-stack-components",children:"2. Stack Components"}),"\n",(0,o.jsx)(n.p,{children:"The script will ask you which L2 stack components you want to deploy:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Enter L2 stack option:                                       \u2551\n\u2551 1 for driver only                                            \u2551\n\u2551 2 for driver + proposer                                      \u2551\n\u2551 3 for driver + proposer + spammer                            \u2551\n\u2551 4 for driver + proposer + prover + spammer                   \u2551\n\u2551 5 for all except spammer                                     \u2551\n\u2551 [default: all]                                               \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Driver"})," - Starts the Nethermind Execution Client for L2 network operation"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Proposer"})," - Initiates the Proposer service for transaction bundling and block proposals"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Prover"})," - Starts the Prover Relayer for proof relay, this component requests proofs from your provers and submits them on-chain"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Spammer"})," - Launches a transaction spammer to generate load on the L2 network for testing purposes"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"BlockScout"})," - Block explorer for L2 (included in all options)"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Choose the option that best fits your testing or deployment needs. For a full setup, select the default (all components) or option ",(0,o.jsx)(n.code,{children:"5"})," to deploy all components except the spammer."]}),"\n",(0,o.jsx)(n.h3,{id:"3-relayer-and-l2-smart-contracts",children:"3. Relayer and L2 Smart Contracts"}),"\n",(0,o.jsx)(n.p,{children:"The script will ask you:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Start relayers? (true/false) [default: true]                 \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,o.jsxs)(n.p,{children:["If you choose ",(0,o.jsx)(n.code,{children:"true"}),", the script will:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Deploy L2 Smart Contracts"})," (for Devnet only) - Deploys the L2 side of the bridge contracts"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Initialize Services"})," - Sets up database and message queues"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Run Migrations"})," - Executes database schema migrations"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Start Relayers"})," - Launches L1 and L2 relayer services"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Generate Bridge UI Configs"})," - Creates configuration files for the Bridge UI"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Start Bridge UI"})," - Launches the user interface for cross-chain transfers"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"bridge-ui",children:"Bridge UI"}),"\n",(0,o.jsx)(n.p,{children:"The Bridge UI is the user-facing interface for transferring assets between Layer 1 and Layer 2, enabling seamless interaction with Surge's cross-chain functionality. It relies on the underlying Relayer and smart contracts to facilitate these transfers securely."}),"\n",(0,o.jsx)(n.p,{children:"The script automatically generates configuration files including:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"configs/configuredBridges.json"})," - Bridge contract addresses"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"configs/configuredChains.json"})," - Chain configurations"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"configs/configuredRelayer.json"})," - Relayer endpoints"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"configs/configuredEventIndexer.json"})," - Event indexer configuration"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"configs/configuredCustomTokens.json"})," - Custom token configurations"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"relayer",children:"Relayer"}),"\n",(0,o.jsx)(n.p,{children:"The Relayer is a key component that facilitates cross-layer communication between Layer 1 and Layer 2, such as submitting proofs or syncing finalized state. It ensures that Surge's L2 state transitions are correctly reflected and verified on L1."}),"\n",(0,o.jsx)(n.h4,{id:"blockscout",children:"BlockScout"}),"\n",(0,o.jsx)(n.p,{children:"Provides a web-based interface to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Explore blocks, transactions, and accounts"}),"\n",(0,o.jsx)(n.li,{children:"Verify smart contracts"}),"\n",(0,o.jsx)(n.li,{children:"Monitor network activity"}),"\n",(0,o.jsx)(n.li,{children:"Track token transfers and balances"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"cleanup-and-management",children:"Cleanup and Management"}),"\n",(0,o.jsx)(n.h3,{id:"removing-deployment",children:"Removing Deployment"}),"\n",(0,o.jsx)(n.p,{children:"To clean up your deployment, use the removal script:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"./surge-remover.sh\n"})}),"\n",(0,o.jsx)(n.p,{children:"This script will:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Stop and remove all Docker containers"}),"\n",(0,o.jsx)(n.li,{children:"Clean up databases and data directories"}),"\n",(0,o.jsx)(n.li,{children:"Remove generated configuration files"}),"\n",(0,o.jsx)(n.li,{children:"Remove Docker networks"}),"\n",(0,o.jsxs)(n.li,{children:["Preserve the ",(0,o.jsx)(n.code,{children:".env"})," file (commented out by default)"]}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{title:"Data Loss",type:"warning",children:(0,o.jsx)(n.p,{children:"The removal script will permanently delete all blockchain data, databases, and configurations. Make sure to backup any important data before running this script."})}),"\n",(0,o.jsx)(n.h2,{id:"verification",children:"Verification"}),"\n",(0,o.jsx)(n.p,{children:"After deploying all components, ensure everything is running correctly by:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Checking the status of Docker containers using ",(0,o.jsx)(n.code,{children:"docker compose ps"})]}),"\n",(0,o.jsx)(n.li,{children:"Checking prover logs to ensure they are operating correctly"}),"\n",(0,o.jsx)(n.li,{children:"Sending test transactions on L2 and verifying they are processed and finalized on L1"}),"\n",(0,o.jsxs)(n.li,{children:["Accessing BlockScout for L1 and L2 chain exploration and verification:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"L1 BlockScout:"})," ",(0,o.jsx)(n.code,{children:"http://localhost:36005"})," (or your configured port)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"L2 BlockScout:"})," ",(0,o.jsx)(n.code,{children:"http://localhost:3000"})," (or your configured ",(0,o.jsx)(n.code,{children:"BLOCKSCOUT_FRONTEND_PORT"}),")"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["Accessing the Bridge UI: ",(0,o.jsx)(n.code,{children:"http://localhost:3001"})," (or your configured port)"]}),"\n",(0,o.jsxs)(n.li,{children:["Checking relayer APIs:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"L1 Relayer:"})," ",(0,o.jsx)(n.code,{children:"http://localhost:4102"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"L2 Relayer:"})," ",(0,o.jsx)(n.code,{children:"http://localhost:4103"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.admonition,{title:"Port Configuration",type:"tip",children:[(0,o.jsxs)(n.p,{children:["The actual ports may vary based on your ",(0,o.jsx)(n.code,{children:".env"})," configuration. Check your environment variables for the exact ports:"]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"L2_HTTP_PORT"})," (default: 8547) for L2 RPC"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"BLOCKSCOUT_FRONTEND_PORT"})," (default: 3000) for BlockScout"]}),"\n",(0,o.jsx)(n.li,{children:"Relayer ports are typically 4102 (L1) and 4103 (L2)"}),"\n"]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},9365:(e,n,r)=>{r.d(n,{A:()=>i});r(6540);var t=r(4164);const o={tabItem:"tabItem_Ymn6"};var s=r(4848);function i({children:e,hidden:n,className:r}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,t.A)(o.tabItem,r),hidden:n,children:e})}},1470:(e,n,r)=>{r.d(n,{A:()=>S});var t=r(6540),o=r(4164),s=r(7559),i=r(3104),l=r(6347),a=r(205),c=r(7485),d=r(1682),h=r(679);function u(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:r}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:r,default:t}})=>({value:e,label:n,attributes:r,default:t})))}(r);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function g({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const r=(0,l.W6)(),o=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(o),(0,t.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(r.location.search);n.set(o,e),r.replace({...r.location,search:n.toString()})}),[o,r])]}function x(e){const{defaultValue:n,queryString:r=!1,groupId:o}=e,s=p(e),[i,l]=(0,t.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!g({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s}))),[c,d]=m({queryString:r,groupId:o}),[u,x]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[r,o]=(0,h.Dv)(n);return[r,(0,t.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:o}),y=(()=>{const e=c??u;return g({value:e,tabValues:s})?e:null})();(0,a.A)((()=>{y&&l(y)}),[y]);return{selectedValue:i,selectValue:(0,t.useCallback)((e=>{if(!g({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),x(e)}),[d,x,s]),tabValues:s}}var y=r(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=r(4848);function v({className:e,block:n,selectedValue:r,selectValue:t,tabValues:s}){const l=[],{blockElementScrollPositionUntilNextRender:a}=(0,i.a_)(),c=e=>{const n=e.currentTarget,o=l.indexOf(n),i=s[o].value;i!==r&&(a(n),t(i))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=l.indexOf(e.currentTarget)+1;n=l[r]??l[0];break}case"ArrowLeft":{const r=l.indexOf(e.currentTarget)-1;n=l[r]??l[l.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},e),children:s.map((({value:e,label:n,attributes:t})=>(0,j.jsx)("li",{role:"tab",tabIndex:r===e?0:-1,"aria-selected":r===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...t,className:(0,o.A)("tabs__item",f.tabItem,t?.className,{"tabs__item--active":r===e}),children:n??e},e)))})}function b({lazy:e,children:n,selectedValue:r}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find((e=>e.props.value===r));return e?(0,t.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function k(e){const n=x(e);return(0,j.jsxs)("div",{className:(0,o.A)(s.G.tabs.container,"tabs-container",f.tabList),children:[(0,j.jsx)(v,{...n,...e}),(0,j.jsx)(b,{...n,...e})]})}function S(e){const n=(0,y.A)();return(0,j.jsx)(k,{...e,children:u(e.children)},String(n))}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var t=r(6540);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);