"use strict";(self.webpackChunksurge_docs=self.webpackChunksurge_docs||[]).push([[8921],{7215:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"guides/running-surge/prepare-l2-genesis","title":"Prepare L2 Genesis","description":"If you\'re using simple-surge-node to deploy L2, you can skip this section since simple-surge-node repository already includes a ready-to-use chainspec.json file.","source":"@site/docs/guides/running-surge/prepare-l2-genesis.mdx","sourceDirName":"guides/running-surge","slug":"/guides/running-surge/prepare-l2-genesis","permalink":"/docs/guides/running-surge/prepare-l2-genesis","draft":false,"unlisted":false,"editUrl":"https://github.com/NethermindEth/surge-docs/tree/main/docs/guides/running-surge/prepare-l2-genesis.mdx","tags":[],"version":"current","lastUpdatedAt":1745227729000,"sidebarPosition":3,"frontMatter":{"title":"Prepare L2 Genesis","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Deploy Protocols on L1","permalink":"/docs/guides/running-surge/deploy-l1-protocols"},"next":{"title":"Set up a Prover","permalink":"/docs/guides/running-surge/provers/"}}');var r=s(4848),t=s(8453);const o={title:"Prepare L2 Genesis",sidebar_position:3},c="Prepare L2 Genesis",l={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Steps",id:"steps",level:2},{value:"1. Clone the Repository",id:"1-clone-the-repository",level:3},{value:"2. Checkout Correct Branch",id:"2-checkout-correct-branch",level:3},{value:"3. Install Dependencies",id:"3-install-dependencies",level:3},{value:"4. Configure Environment Variables",id:"4-configure-environment-variables",level:3},{value:"5. Generate L2 Genesis File",id:"5-generate-l2-genesis-file",level:3},{value:"6. Download Genesis-to-Chainspec Converter",id:"6-download-genesis-to-chainspec-converter",level:3},{value:"7. Convert Genesis to Chainspec",id:"7-convert-genesis-to-chainspec",level:3},{value:"8. Retrieve the Genesis Hash",id:"8-retrieve-the-genesis-hash",level:3},{value:"9. Clean Up (Optional)",id:"9-clean-up-optional",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"prepare-l2-genesis",children:"Prepare L2 Genesis"})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.mdxAdmonitionTitle,{children:["Skip if Using ",(0,r.jsx)(n.code,{children:"simple-surge-node"})]}),(0,r.jsxs)(n.p,{children:["If you're using ",(0,r.jsx)(n.a,{href:"https://github.com/NethermindEth/simple-surge-node",children:(0,r.jsx)(n.code,{children:"simple-surge-node"})})," to ",(0,r.jsx)(n.a,{href:"/docs/guides/running-surge/deploy-l2",children:"deploy L2"}),", you can ",(0,r.jsx)(n.strong,{children:"skip this section"})," since ",(0,r.jsx)(n.code,{children:"simple-surge-node"})," repository already includes a ready-to-use ",(0,r.jsxs)(n.a,{href:"https://github.com/NethermindEth/simple-surge-node/blob/main/static/chainspec.json",children:[(0,r.jsx)(n.code,{children:"chainspec.json"})," file"]}),"."]})]}),"\n",(0,r.jsx)(n.p,{children:"This guide walks you through preparing your own L2 genesis file, chainspec file, and genesis hash which are required to deploy an L2 network."}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Before proceeding, ensure the following tools are installed:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/foundry-rs/foundry#installation",children:"Foundry"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pnpm.io/installation",children:"pnpm"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://jqlang.org/download/",children:"jq"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/get-docker/",children:"Docker"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,r.jsx)(n.h3,{id:"1-clone-the-repository",children:"1. Clone the Repository"}),"\n",(0,r.jsxs)(n.p,{children:["Clone the ",(0,r.jsx)(n.code,{children:"surge-taiko-mono"})," repository and navigate into it:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/NethermindEth/surge-taiko-mono.git\ncd surge-taiko-mono\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-checkout-correct-branch",children:"2. Checkout Correct Branch"}),"\n",(0,r.jsxs)(n.p,{children:["Checkout the ",(0,r.jsx)(n.code,{children:"surge/devnet"})," branch:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git checkout surge/devnet\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-install-dependencies",children:"3. Install Dependencies"}),"\n",(0,r.jsx)(n.p,{children:"Navigate to the protocol package and install dependencies:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd packages/protocol\nfoundryup\npnpm install\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-configure-environment-variables",children:"4. Configure Environment Variables"}),"\n",(0,r.jsx)(n.p,{children:"Set required environment variables:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"export CONTRACT_OWNER=0x8943545177806ED17B9F23F0a21ee5948eCaa776\nexport L1_CHAINID=3151908\nexport L2_CHAINID=763374\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-generate-l2-genesis-file",children:"5. Generate L2 Genesis File"}),"\n",(0,r.jsx)(n.p,{children:"Compile L2 contracts and generate the genesis block:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm compile:l2\npnpm genesis:gen\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["The generated files can be found at ",(0,r.jsx)(n.code,{children:"./test/genesis/data/"}),"."]})}),"\n",(0,r.jsx)(n.h3,{id:"6-download-genesis-to-chainspec-converter",children:"6. Download Genesis-to-Chainspec Converter"}),"\n",(0,r.jsx)(n.p,{children:"Download the script used to convert the genesis file to a chainspec file:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl -O https://raw.githubusercontent.com/NethermindEth/core-scripts/refs/heads/main/gen2spec/gen2spec.jq\n"})}),"\n",(0,r.jsx)(n.h3,{id:"7-convert-genesis-to-chainspec",children:"7. Convert Genesis to Chainspec"}),"\n",(0,r.jsx)(n.p,{children:"Convert the genesis file into a chainspec file:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'cat ./test/genesis/data/genesis.json | jq ". * {\n  difficulty: 0,\n  config: {\n    taiko: true,\n    londonBlock: 0,\n    ontakeBlock: 1,\n    shanghaiTime: 0\n  }\n} | del(.config.clique)" | jq --from-file ./gen2spec.jq | jq \'.params.feeCollector = "0x0000000000000000000000000000000000000000"\' > ./test/genesis/data/chainspec.json\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["The chainspec file will be created at ",(0,r.jsx)(n.code,{children:"./test/genesis/data/chainspec.json"}),"."]})}),"\n",(0,r.jsx)(n.h3,{id:"8-retrieve-the-genesis-hash",children:"8. Retrieve the Genesis Hash"}),"\n",(0,r.jsx)(n.p,{children:"Use the Nethermind client Docker container to retrieve the genesis hash:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker run -d \\\n  --name nethermind-genesis-hash \\\n  -v ./test/genesis/data/chainspec.json:/chainspec.json \\\n  nethermindeth/nethermind:surge-fd87ddb09 \\\n  --config=none \\\n  --Init.ChainSpecPath=/chainspec.json\n\nsleep 5 # Wait a few seconds for the container to initialize\n\ndocker logs nethermind-genesis-hash 2>/dev/null | grep \"Genesis hash\" | head -n 1 | sed 's/.*Genesis hash : \\(.*\\)/\\1/'\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"The genesis hash will be printed in the console."})}),"\n",(0,r.jsx)(n.h3,{id:"9-clean-up-optional",children:"9. Clean Up (Optional)"}),"\n",(0,r.jsx)(n.p,{children:"Stop and remove the Docker container after obtaining the genesis hash:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker rm -f nethermind-genesis-hash\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var i=s(6540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);