---
title: Deploy L2 and Surge Protocols
sidebar_position: 2
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Deploy L2 and Surge Protocols

A Layer 2 network builds on top of Layer 1 to increase scalability and reduce transaction costs, while still inheriting L1â€™s security. For Surge, the L2 network is where user transactions are executed and blocks are proposed and proven.

This guide provides clear instructions for deploying Surgeâ€™s L2 components using the [Simple Surge Node](https://github.com/NethermindEth/simple-surge-node), enabling you to run and test the core rollup logic.

To see how L2 fits into the overall system, refer to the [Surge Architecture documentation](/docs/about/architecture).

## Protocol Deployment

Follow these steps to set up and deploy your L2 protocol:

### 1. Clone Repository

Clone the [Simple Surge Node](https://github.com/NethermindEth/simple-surge-node) repository and navigate into the directory:

```bash
git clone https://github.com/NethermindEth/simple-surge-node.git
cd simple-surge-node
```

### 2. Configure Environment

Create your environment configuration file (`.env`) by copying the provided sample:

```bash
cp .env.devnet .env
```

:::tip Environment Configuration
The `.env.devnet` file includes default values for the devnet configuration, based on previously generated data. You can customize these values, such as L1 and L2 settings, genesis hashes, and addresses, as needed.
:::

:::note
`host.docker.internal` values in the `.env` file might not work in all environments. If you encounter issues, replace `host.docker.internal` with your server's IP address or hostname.
:::

### 3. Start Protocol Deployment Script

[Simple Surge Node](https://github.com/NethermindEth/simple-surge-node) automates the deployment of L2 and Surge protocol components using a convenient script.
Run the deployment script with:

```bash
./surge-protocol-deployer.sh
```

You'll be prompted to confirm the deployment parameters. Here are some of them:

```bash 
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  âš ï¸ Select which Surge environment to use:
â•‘â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•‘
â•‘ 1 for Devnet                                                 â•‘
â•‘ 2 for Staging                                                â•‘
â•‘ 3 for Testnet                                                â•‘
â•‘ [default: Devnet]                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  ğŸš€ Using Devnet Environment
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  âš ï¸ Select remote or local:
â•‘â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•‘
â•‘ 0 for local                                                  â•‘
â•‘ 1 for remote                                                 â•‘
â•‘ [default: local]                                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  âš ï¸ Select which devnet machine to use:
â•‘â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•‘
â•‘ 1 for Devnet 1 (prover)                                      â•‘
â•‘ 2 for Devnet 2 (taiko-client)                                â•‘
â•‘ [default: others]                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

2

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  ğŸš€ Using Devnet 2 (taiko-client)
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Use timelocked owner? (true/false) [default: false]          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

#### Surge Environment

The script is configured for Surge devnet, staging, and testnet environments.
You can use devnet for local testing. 

#### Remote or Local

Choose `local` if you are deploying everything on a single machine. Choose `remote` if you are deploying across multiple machines.

#### Devnet Machine

This option is only available when you select `Devnet` environment. 
If you are deploying custom devnet, choose `others`.

#### Timelocked Owner 

You can choose whether to use a timelocked owner for the deployed contracts.
This feature allows transferring the ownership of the contracts to a timelock contract,
which will delay any ownership changes by a predefined time period.

For testing and non-production environments, you can safely choose `false` to simplify management.

Note that with a timelocked owner you won't be able to re-register provers and change these parameters later without redeploying the protocol.



:::tip 
After these prompts, the script will deploy protocol contracts and output addresses of created smart contracts.
Some of these addresses (e.g. `SUCCINCT_VERIFIER`, `RISC0_GROTH16_VERIFIER`) are required for prover configuration.
You can also find these addresses in the `deployment/deploy_l1.json` file.
:::

:::tip
You can safely cancel the script at any time by pressing `Ctrl + C`. The script saves the progress and you can resume later.
If you have already deployed the protocol contracts, the script will ask you: 
```bash
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  âš ï¸ Surge L1 deployment already completed
  (deploy_l1.json exists)
â•‘â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•‘
â•‘ Start a new deployment? (true/false) [default: false]        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
Here you can redeploy the protocol or just use the existing deployment.
:::


### 4. Prover Registration 

In Surge, provers are required to be registered in the protocol before they can start proving tasks.
In the next step you will be asked whether provers are running and ready for registration:

```bash
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Running provers? (true/false) [default: false]               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
You can type `false` and skip this step if you don't want to run provers.
Otherwise, if you want to run provers, just type `true` and follow the instructions in the 
[Provers Setup Guide](provers/index.mdx) to deploy and register your provers before continuing.


### 5. Depositing Bond 

The script will ask you whether you want to deposit the proving liveness bond for your provers:

```bash
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Deposit bond? (true/false) [default: true]                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

It's recommended to deposit the bond to ensure your provers remain active and available for proving tasks.
Type `true` and then follow the prompts to complete the bond deposit process.

### 6. Next Steps

After completing the protocol deployment, you can proceed to deploy Surge stack components.


## Stack Deployment

### 1. Start Script 

Start the script for deploying Surge stack components:
```bash 
./surge-stack-deployer.sh
```

You'll see the same prompts as in the [3. Start Protocol Deployment Script section](#3-start-protocol-deployment-script).
Set the same values as before to ensure the script uses the correct configuration. 

### 2. Stack Components

The script will ask you which components you want to deploy:

```bash
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Enter L2 stack option:                                       â•‘
â•‘ 1 for driver only                                            â•‘
â•‘ 2 for driver + proposer                                      â•‘
â•‘ 3 for driver + proposer + spammer                            â•‘
â•‘ 4 for driver + proposer + prover + spammer                   â•‘
â•‘ 5 for all except spammer                                     â•‘
â•‘ [default: all]                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

- `Driver` - Starts the Nethermind Execution Client for L2 network operation

- `Proposer` - Initiates the Proposer service for transaction bundling and block proposals

- `Prover` - Starts the Prover Relayer for proof relay, this component requests proofs from your provers and submits them on-chain.

- `Spammer` - Launches a transaction spammer to generate load on the L2 network for testing purposes

Choose the option that best fits your testing or deployment needs. For a full setup, select option `5` to deploy all components except the spammer.

### 3. Relayer and L2 Smart Contracts

The script will ask you:

```bash
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Start relayers? (true/false) [default: true]                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

In this step the script starts the relayer for L1 and L2 communication, deploys L2 smart contracts 
and starts several other components like Bridge UI and BlockScout.

#### Bridge UI
The Bridge UI is the user-facing interface for transferring assets between Layer 1 and Layer 2, enabling seamless interaction with Surgeâ€™s cross-chain functionality. It relies on the underlying Relayer and smart contracts to facilitate these transfers securely.

#### Relayer 
The Relayer is a key component that facilitates cross-layer communication between Layer 1 and Layer 2, such as submitting proofs or syncing finalized state. It ensures that Surgeâ€™s L2 state transitions are correctly reflected and verified on L1.

#### BlockScout
Provides a web-based interface to:
- Explore blocks, transactions, and accounts
- Verify smart contracts
- Monitor network activity
- Track token transfers and balances



## Verification

After deploying all components, ensure everything is running correctly by:

- Checking the status of Docker containers using `docker compose ps`.
- Checking prover logs to ensure they are operating correctly.
- Sending test transactions on L2 and verifying they are processed and finalized on L1.
- Accessing BlockScout for L1 and L2 chain exploration and verification:
  - *L1 BlockScout:* [http://localhost:36004](http://localhost:36004)
  - *L2 BlockScout:* [http://localhost:4000](http://localhost:4000)


